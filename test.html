<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Start Interview ‚Äî RecruitAI</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600;700;800&family=DM+Sans:wght@300;400;500;600&family=Plus+Jakarta+Sans:wght@700;800&display=swap" rel="stylesheet">
<style>
:root {
  --bg: #0f1117;
  --bg2: #161b27;
  --s: #1a2035;
  --s2: #1e2640;
  --border: #2a3350;
  --border2: #334066;
  --accent: #4f8ef7;
  --accent2: #6aa3ff;
  --accent-light: rgba(79,142,247,0.12);
  --accent-glow: rgba(79,142,247,0.2);
  --green: #10b981;
  --red: #ef4444;
  --yellow: #f59e0b;
  --text: #e8edf5;
  --text2: #c5cde0;
  --muted: #7a88a8;
  --shadow: 0 1px 3px rgba(0,0,0,0.4), 0 4px 12px rgba(0,0,0,0.3);
  --shadow-lg: 0 4px 20px rgba(0,0,0,0.5), 0 12px 40px rgba(0,0,0,0.4);
}


*{margin:0;padding:0;box-sizing:border-box;}
body{font-family:'DM Sans', sans-serif;background:var(--bg);color:var(--text);min-height:100vh;}
.topbar{background:var(--s);border-bottom:1px solid var(--border);padding:0 32px;height:60px;display:flex;align-items:center;justify-content:space-between;}
.brand{font-family:'Plus Jakarta Sans', 'Playfair Display', sans-serif;font-size:18px;font-weight:800;background:linear-gradient(135deg,#fff,var(--accent2));background-clip:text;-webkit-background-clip:text;-webkit-text-fill-color:transparent;}
.topbar-right{display:flex;align-items:center;gap:16px;font-size:13px;color:var(--muted);}
.logout-link{padding:7px 16px;border:1px solid var(--border);border-radius:7px;color:var(--text);cursor:pointer;font-size:13px;text-decoration:none;transition:all .2s;}
.logout-link:hover{border-color:var(--accent);color:var(--accent2);}
.main{max-width:820px;margin:0 auto;padding:48px 20px;}
.greeting h1{font-family:'Playfair Display', serif;font-size:34px;font-weight:800;margin-bottom:8px;background:linear-gradient(135deg,#fff 40%,var(--accent2));background-clip:text;-webkit-background-clip:text;-webkit-text-fill-color:transparent;}
.greeting p{color:var(--muted);font-size:15px;margin-bottom:36px;}

/* Room code join box ‚Äî now the main focus */
.join-card{background:var(--s);border:1px solid var(--border);border-radius:20px;padding:40px;margin-bottom:32px;text-align:center;}
.join-icon{font-size:56px;margin-bottom:16px;}
.join-title{font-family:'Playfair Display', serif;font-size:22px;font-weight:800;margin-bottom:8px;}
.join-desc{color:var(--muted);font-size:14px;margin-bottom:28px;line-height:1.6;}
.join-input-row{display:flex;gap:12px;max-width:460px;margin:0 auto;}
.join-input-row input{flex:1;padding:14px 18px;background:var(--s2);border:2px solid var(--border);border-radius:10px;color:var(--text);font-size:20px;font-family:monospace;letter-spacing:.15em;text-transform:uppercase;outline:none;text-align:center;transition:border-color .2s;}
.join-input-row input:focus{border-color:var(--accent);}
.btn-join{padding:14px 28px;background:var(--accent);border:none;border-radius:10px;color:#fff;font-size:15px;font-weight:700;cursor:pointer;font-family:'DM Sans', sans-serif;transition:all .25s;white-space:nowrap;}
.btn-join:hover{transform:translateY(-1px);box-shadow:0 8px 20px rgba(13,31,60,0.3);}

/* Info cards showing what each mode looks like */
.info-section{margin-bottom:32px;}
.info-title{font-family:'Playfair Display', serif;font-size:15px;font-weight:700;color:var(--muted);text-transform:uppercase;letter-spacing:.06em;margin-bottom:14px;}
.info-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;}
.info-card{background:var(--s);border:1px solid var(--border);border-radius:12px;padding:18px;text-align:center;opacity:.7;}
.info-card-icon{font-size:28px;margin-bottom:8px;}
.info-card-title{font-family:'Playfair Display', serif;font-size:13px;font-weight:700;margin-bottom:4px;}
.info-card-desc{font-size:11px;color:var(--muted);line-height:1.5;}

/* Past attempts */
.past-section{margin-top:40px;}
.section-title{font-family:'Playfair Display', serif;font-size:17px;font-weight:700;margin-bottom:14px;}
.sub-card{background:var(--s);border:1px solid var(--border);border-radius:12px;padding:18px;margin-bottom:10px;display:flex;align-items:center;gap:14px;flex-wrap:wrap;}
.sub-info{flex:1;min-width:180px;}
.sub-role{font-size:15px;font-weight:600;margin-bottom:3px;}
.sub-meta{font-size:12px;color:var(--muted);}
.sub-scores{display:flex;gap:14px;}
.ss{text-align:center;}
.ss-val{font-size:20px;font-weight:700;font-family:'Playfair Display', serif;}
.ss-lbl{font-size:10px;color:var(--muted);text-transform:uppercase;}
.badge{display:inline-block;padding:3px 10px;border-radius:20px;font-size:11px;font-weight:600;}
.badge-green{background:rgba(16,185,129,.12);color:#6ee7b7;}
.badge-red{background:rgba(244,63,94,.12);color:#fda4af;}
.btn-view{padding:8px 16px;background:var(--s2);border:1px solid var(--border);border-radius:7px;color:var(--text);font-size:12px;cursor:pointer;transition:all .2s;}
.btn-view:hover{border-color:var(--accent);color:var(--accent2);}
.empty{text-align:center;padding:36px;color:var(--muted);font-size:14px;background:var(--s);border-radius:12px;border:1px solid var(--border);}

/* Hint text */
.hint-box{background:rgba(13,31,60,0.04);border:1px solid rgba(13,31,60,0.15);border-radius:10px;padding:14px 18px;font-size:13px;color:var(--muted);text-align:center;margin-top:16px;line-height:1.6;}
.hint-box strong{color:var(--accent);}


.brand { color: var(--accent); -webkit-text-fill-color: var(--accent); }
.brand-name { color: var(--text); -webkit-text-fill-color: var(--text); }



/* Subtle background texture */
body::before {
  content: '';
  position: fixed;
  inset: 0;
  background-image: radial-gradient(circle at 20% 20%, rgba(13,31,60,0.05) 0%, transparent 50%),
                    radial-gradient(circle at 80% 80%, rgba(37,99,235,0.04) 0%, transparent 50%);
  pointer-events: none;
  z-index: 0;
}

/* Cards elevated */
.card, .stat, .join-card, .result-header, .score-card, .modal-card {
  box-shadow: 0 1px 3px rgba(15,30,60,0.06), 0 4px 16px rgba(15,30,60,0.08);
  transition: box-shadow 0.2s ease;
}
.card:hover, .stat:hover {
  box-shadow: 0 2px 8px rgba(15,30,60,0.08), 0 8px 24px rgba(15,30,60,0.1);
}

/* Topbar elevated */
.topbar {
  box-shadow: 0 1px 0 var(--border), 0 2px 8px rgba(15,30,60,0.06);
  backdrop-filter: blur(10px);
}

/* Table styling */
table {
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 1px 3px rgba(15,30,60,0.06);
}

/* Stat top bar glow */
.stat.blue::before { background: linear-gradient(90deg, var(--accent), #4a6fa5); }
.stat.green::before { background: linear-gradient(90deg, var(--green), #34d399); }
.stat.yellow::before { background: linear-gradient(90deg, var(--yellow), #fbbf24); }
.stat.red::before { background: linear-gradient(90deg, var(--red), #fc8181); }
.stat.purple::before { background: linear-gradient(90deg, #7c3aed, #a78bfa); }
.stat.teal::before { background: linear-gradient(90deg, #0d9488, #2dd4bf); }

/* Proctoring sidebar brighter */
.proctoring-sidebar {
  background: var(--s);
  border-left: 1px solid var(--border);
}

/* Section titles */
.page-title, .card-title, .section-title, .join-title {
  color: var(--text);
  font-family: 'Playfair Display', serif;
}
.page-sub, .join-desc { color: var(--muted); }

/* Main wrapper bg */
.main, .container { position: relative; z-index: 1; }
.layout { position: relative; z-index: 1; }


/* Dark background with subtle gradient */
body {
  background: var(--bg);
  background-attachment: fixed;
  color: var(--text);
}

/* Subtle dark background decoration */
body::before {
  content: '';
  position: fixed;
  inset: 0;
  background-image: 
    radial-gradient(ellipse at 15% 25%, rgba(13,31,60,0.06) 0%, transparent 45%),
    radial-gradient(ellipse at 85% 75%, rgba(13,31,60,0.03) 0%, transparent 45%);
  pointer-events: none;
  z-index: 0;
}

/* Background grid - subtle on dark */




/* handled via JS scoreColor function updates */


/* Dark scrollbar */
::-webkit-scrollbar{width:6px;height:6px}
::-webkit-scrollbar-track{background:var(--bg2)}
::-webkit-scrollbar-thumb{background:var(--border2);border-radius:3px}
::-webkit-scrollbar-thumb:hover{background:var(--muted)}
</style>
</head>
<body>
<div class="topbar">
  <div class="brand">ü§ñ RecruitAI</div>
  <div class="topbar-right">
    <span>Hello, <strong id="user-name">‚Ä¶</strong></span>
    <a href="/logout" class="logout-link">Logout</a>
  </div>
</div>

<div class="main">
  <div class="greeting">
    <h1 id="greeting-text">Welcome back!</h1>
    <p>Your recruiter will share a room code with you. Enter it below to begin your interview.</p>
  </div>

  <!-- MAIN JOIN CARD ‚Äî only thing student needs -->
  <div class="join-card">
    <div class="join-icon">üîë</div>
    <div class="join-title">Enter Your Room Code</div>
    <div class="join-desc">
      Your recruiter will send you an 8-character room code.<br>
      The interview type and job role have already been set by your recruiter.
    </div>
    <div class="join-input-row">
      <input type="text" id="room-input" placeholder="ABCD1234" maxlength="8"
             onkeydown="if(event.key==='Enter') joinByCode()">
      <button class="btn-join" onclick="joinByCode()">Join ‚Üí</button>
    </div>
    <div class="hint-box">
      üí° Your recruiter controls the <strong>job role</strong> and <strong>interview type</strong>.
      Just enter the room code and your interview will start automatically.
    </div>
  </div>

  <!-- INFO CARDS ‚Äî just for awareness, not clickable -->
  <div class="info-section">
    <div class="info-title">Interview formats you may be assigned</div>
    <div class="info-grid">
      <div class="info-card">
        <div class="info-card-icon">üìù</div>
        <div class="info-card-title">MCQ Exam</div>
        <div class="info-card-desc">10 role-specific multiple choice questions. Auto-graded.</div>
      </div>
      <div class="info-card">
        <div class="info-card-icon">ü§ñ</div>
        <div class="info-card-title">AI Interviewer</div>
        <div class="info-card-desc">Alex our AI interviewer asks and evaluates your answers live.</div>
      </div>
      <div class="info-card">
        <div class="info-card-icon">üé•</div>
        <div class="info-card-title">Live Recruiter</div>
        <div class="info-card-desc">Face-to-face video call with your recruiter in real time.</div>
      </div>
    </div>
  </div>

  <!-- PAST ATTEMPTS -->
  <div class="past-section">
    <div class="section-title">üìã Your Previous Attempts</div>
    <div id="past-list"><div style="color:var(--muted);font-size:14px;padding:20px 0;">Loading‚Ä¶</div></div>
  </div>
</div>

<script>
let currentUser = null;

async function init() {
  const auth = await fetch('/api/check-auth').then(r => r.json());
  if (!auth.authenticated) return window.location.href = 'index.html';
  if (auth.is_admin) return window.location.href = 'recruiter_dashboard.html';
  currentUser = auth;
  document.getElementById('user-name').textContent = auth.full_name || auth.username;
  document.getElementById('greeting-text').textContent = 'Welcome, ' + (auth.full_name || auth.username).split(' ')[0] + '!';
  await loadPast();
}

async function loadPast() {
  const el = document.getElementById('past-list');
  try {
    const data = await fetch('/api/my-submissions').then(r => r.json());
    const mine = data.submissions || [];
    if (!mine.length) {
      el.innerHTML = '<div class="empty">No previous attempts yet. Join an interview using your room code above!</div>';
      return;
    }
    el.innerHTML = mine.map(s => `
      <div class="sub-card">
        <div class="sub-info">
          <div class="sub-role">${s.job_role || 'General'}
            <span style="font-size:11px;background:rgba(13,31,60,0.08);color:var(--accent2);padding:2px 8px;border-radius:10px;margin-left:6px;">
              ${(s.mode || 'mcq').replace(/_/g, ' ')}
            </span>
          </div>
          <div class="sub-meta">${s.submitted_at} ¬∑ Attempt #${s.attempt_number || 1}</div>
        </div>
        <span style="font-size:13px;color:var(--muted);font-style:italic;">‚è≥ Under review by recruiter</span>
      </div>`).join('');
  } catch(e) {
    el.innerHTML = '<div class="empty">Could not load history.</div>';
  }
}

function scoreColor(s) {
  return s >= 80 ? '#10b981' : s >= 60 ? '#f59e0b' : '#f43f5e';
}

function joinByCode() {
  const code = document.getElementById('room-input').value.trim().toUpperCase();
  if (code.length < 6) return;
  window.location.href = `interview_room.html?room=${code}`;
}

init();
</script>
</body>
</html>